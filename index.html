<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>QuasiCare | Home</title>
  <style>
    :root {
      --bg-gradient-light: linear-gradient(-45deg, #1f1c2c, #928dab, #0f2027, #2c5364);
      --bg-gradient-dark: linear-gradient(-45deg, #0d0d0d, #1a1a1a, #101010, #050505);
      --text-color-light: white;
      --text-color-dark: #ccc;
      --accent-color: #00ffc8;
    }

    * {
      box-sizing: border-box;
    }

    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      transition: background 0.5s ease, color 0.5s ease;
    }

    body {
      background: var(--bg-gradient-light);
      background-size: 400% 400%;
      animation: gradientBG 20s ease infinite;
      color: var(--text-color-light);
    }

    body.dark-mode {
      background: var(--bg-gradient-dark);
      color: var(--text-color-dark);
    }

    @keyframes gradientBG {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    header {
      padding: 20px;
      text-align: center;
    }

    h1 {
      font-size: 2rem;
      margin: 0;
    }

    .subheading {
      font-size: 1.1rem;
      margin-top: 6px;
      color: #aaa;
    }

    .container {
      padding: 20px;
      max-width: 800px;
      margin: auto;
      text-align: center;
    }

    .counter p span {
      color: var(--accent-color);
      font-weight: bold;
    }

    .breathe-heart {
      width: 100px;
      height: 90px;
      background-color: var(--accent-color);
      mask: url('https://upload.wikimedia.org/wikipedia/commons/e/e7/Heart_corazón.svg') no-repeat center;
      -webkit-mask: url('https://upload.wikimedia.org/wikipedia/commons/e/e7/Heart_corazón.svg') no-repeat center;
      mask-size: contain;
      -webkit-mask-size: contain;
      animation: beat 3s ease-in-out infinite;
      margin: 30px auto;
    }

    @keyframes beat {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.3); }
    }

    .microtext {
      font-size: 0.9rem;
      color: #aaa;
      margin-top: -10px;
    }

    .affirmation {
      margin-top: 30px;
      font-style: italic;
      font-size: 1.1rem;
      opacity: 0;
      animation: fadeIn 1s ease forwards;
    }

    @keyframes fadeIn {
      to { opacity: 1; }
    }

    .theme-toggle {
      margin-top: 30px;
      padding: 10px 16px;
      font-size: 14px;
      border: none;
      border-radius: 6px;
      background-color: #fff;
      color: #333;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    .theme-toggle:hover {
      background-color: #eee;
    }

    @media (max-width: 600px) {
      h1 { font-size: 1.5rem; }
      .breathe-heart { width: 80px; height: 70px; }
    }
  </style>
</head>
<body>
  <header>
    <h1>Welcome to <span class="logo">QuasiCare</span></h1>
    <p class="subheading">Helping you heal, one breath at a time</p>
  </header>

  <div class="container">
    <div class="counter">
      <p>Souls lost in the U.S. (2025): <span id="usCount">0</span></p>
      <p>Souls lost globally (2025): <span id="globalCount">0</span></p>
    </div>

    <div class="breathe-heart"></div>
    <p class="microtext">Each beat reminds us of those lost, and those still here. Breathe with compassion.</p>

    <div class="affirmation" id="affirmation">You are enough. You are doing your best.</div>

    <button class="theme-toggle" onclick="toggleTheme()">Toggle Theme</button>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCbrPC0NZDr8yZ4xTTBayBbOnESETg9xuw",
      authDomain: "quasicare.firebaseapp.com",
      projectId: "quasicare",
      storageBucket: "quasicare.appspot.com",
      messagingSenderId: "197366070004",
      appId: "1:197366070004:web:2972eb9297102b6183bca1"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    onAuthStateChanged(auth, user => {
      if (!user) window.location.href = "login.html";
    });

    // Suicide Counter
    const usRateSec = 11 * 60;
    const globalRateSec = 40;
    const startOfYear = new Date("2025-01-01T00:00:00Z").getTime();
    const usEl = document.getElementById("usCount");
    const globalEl = document.getElementById("globalCount");

    const getCounts = () => {
      const now = Date.now();
      const seconds = Math.floor((now - startOfYear) / 1000);
      return {
        us: Math.floor(seconds / usRateSec),
        global: Math.floor(seconds / globalRateSec)
      };
    };

    const animateCount = (el, to) => {
      let start = 0, duration = 1500, startTime = performance.now();
      const update = time => {
        const progress = Math.min((time - startTime) / duration, 1);
        el.innerText = Math.floor(progress * to).toLocaleString();
        if (progress < 1) requestAnimationFrame(update);
      };
      requestAnimationFrame(update);
    };

    const { us, global } = getCounts();
    animateCount(usEl, us);
    animateCount(globalEl, global);

    setInterval(() => { usEl.innerText = (++us).toLocaleString(); }, usRateSec * 1000);
    setInterval(() => { globalEl.innerText = (++global).toLocaleString(); }, globalRateSec * 1000);

    // Affirmations
    const affirmations = [
      "You are enough. You are doing your best.",
      "You made it here. That matters.",
      "Even your smallest efforts count.",
      "You're allowed to rest and heal.",
      "Keep going. You are not alone."
    ];
    let index = 0;
    const el = document.getElementById("affirmation");
    setInterval(() => {
      index = (index + 1) % affirmations.length;
      el.style.opacity = 0;
      setTimeout(() => {
        el.innerText = affirmations[index];
        el.style.opacity = 1;
      }, 300);
    }, 7000);

    // Theme toggle
    function toggleTheme() {
      document.body.classList.toggle("dark-mode");
    }
  </script>
</body>
</html>
